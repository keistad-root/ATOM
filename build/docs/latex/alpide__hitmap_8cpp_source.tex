\doxysection{alpide\+\_\+hitmap.\+cpp}
\hypertarget{alpide__hitmap_8cpp_source}{}\label{alpide__hitmap_8cpp_source}\index{/home/ychoi/ATOM/exe/alpide\_hitmap.cpp@{/home/ychoi/ATOM/exe/alpide\_hitmap.cpp}}
\mbox{\hyperlink{alpide__hitmap_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <filesystem>}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <numeric>}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ "{}TCanvas.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ "{}TH2.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}TStyle.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}TText.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ "{}TPaveText.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cppargs_8h}{cppargs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#include\ "{}alpide\_decoder.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00014}00014\ \textcolor{preprocessor}{\#include\ "{}pitch\_clock.h"{}}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00016}\mbox{\hyperlink{alpide__hitmap_8cpp_aab44b1dab240272ed0bee958aa729f94}{00016}}\ \mbox{\hyperlink{classArgumentParser}{ArgumentParser}}\ \mbox{\hyperlink{alpide__hitmap_8cpp_aab44b1dab240272ed0bee958aa729f94}{set\_parse}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}**\ argv)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00017}00017\ \ \ \ \ \mbox{\hyperlink{classArgumentParser}{ArgumentParser}}\ parser\ =\ \mbox{\hyperlink{classArgumentParser}{ArgumentParser}}(argc,argv).\mbox{\hyperlink{classArgumentParser_a2d7ea458fda2ee2f00e75ab20bf99680}{setDescription}}(\textcolor{stringliteral}{"{}Draw\ hitmap\ and\ calculate\ hitrate\ of\ an\ ALPIDE"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00018}00018\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}rawdata"{}}).\mbox{\hyperlink{classArgumentParser_a5425606bd37027f06b0dbdc87863315a}{metavar}}(\textcolor{stringliteral}{"{}FILENAME"{}}).\mbox{\hyperlink{classArgumentParser_a7cac3ec87e9c8800c373bbf064a6509a}{help}}(\textcolor{stringliteral}{"{}raw\ data\ file\ to\ be\ processed"{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00019}00019\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}-\/-\/bins"{}}).\mbox{\hyperlink{classArgumentParser_a3dff4221e1ae41df3a9b48bca9c8f53f}{add\_minor\_argument}}(\textcolor{stringliteral}{"{}-\/b"{}}).\mbox{\hyperlink{classArgumentParser_abf15da74490e1747938923cab9171dc6}{type}}(\textcolor{stringliteral}{"{}int"{}}).\mbox{\hyperlink{classArgumentParser_ac699bfca10827a904d69b37ba0058c9b}{add\_domain}}(\{\textcolor{stringliteral}{"{}1"{}},\ \textcolor{stringliteral}{"{}2"{}},\ \textcolor{stringliteral}{"{}4"{}},\ \textcolor{stringliteral}{"{}8"{}},\ \textcolor{stringliteral}{"{}16"{}},\ \textcolor{stringliteral}{"{}32"{}}\}).help(\textcolor{stringliteral}{"{}bin\ size"{}}).\mbox{\hyperlink{classArgumentParser_ac057f9c338901af3c6416fdc9e19b043}{set\_default}}(\textcolor{stringliteral}{"{}1"{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00020}00020\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}-\/-\/max"{}}).\mbox{\hyperlink{classArgumentParser_a3dff4221e1ae41df3a9b48bca9c8f53f}{add\_minor\_argument}}(\textcolor{stringliteral}{"{}-\/M"{}}).\mbox{\hyperlink{classArgumentParser_abf15da74490e1747938923cab9171dc6}{type}}(\textcolor{stringliteral}{"{}int"{}}).\mbox{\hyperlink{classArgumentParser_a7cac3ec87e9c8800c373bbf064a6509a}{help}}(\textcolor{stringliteral}{"{}color\ scale\ limit"{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00021}00021\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}-\/-\/path"{}}).\mbox{\hyperlink{classArgumentParser_a7cac3ec87e9c8800c373bbf064a6509a}{help}}(\textcolor{stringliteral}{"{}Output\ plots\ path"{}}).\mbox{\hyperlink{classArgumentParser_ac057f9c338901af3c6416fdc9e19b043}{set\_default}}(\textcolor{stringliteral}{"{}."{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00022}00022\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}-\/-\/dump-\/raw-\/hits"{}}).\mbox{\hyperlink{classArgumentParser_a7cac3ec87e9c8800c373bbf064a6509a}{help}}(\textcolor{stringliteral}{"{}Dump\ hit\ pixel\ addresses\ for\ each\ event\ to\ file"{}}).\mbox{\hyperlink{classArgumentParser_ac057f9c338901af3c6416fdc9e19b043}{set\_default}}(\textcolor{stringliteral}{"{}false"{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00023}00023\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af00214a4cc011bc62671b65bc99b7e70}{add\_argument}}(\textcolor{stringliteral}{"{}-\/-\/dump-\/acc-\/hits"{}}).\mbox{\hyperlink{classArgumentParser_a7cac3ec87e9c8800c373bbf064a6509a}{help}}(\textcolor{stringliteral}{"{}Dump\ hit\ pixel\ addresses\ sorted\ by\ frequency\ to\ file"{}}).\mbox{\hyperlink{classArgumentParser_ac057f9c338901af3c6416fdc9e19b043}{set\_default}}(\textcolor{stringliteral}{"{}false"{}}).\mbox{\hyperlink{classArgumentParser_ac3096e6e13298ac6c77607f5569d2e71}{add\_finish}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00024}00024\ \ \ \ \ parser.\mbox{\hyperlink{classArgumentParser_af2c0b3751dd75a8524f20076f61c9bcf}{parse\_args}}();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{return}\ parser;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00028}\mbox{\hyperlink{alpide__hitmap_8cpp_a04b7c05c67bc55d083fa9a9f7d963efe}{00028}}\ std::ifstream\ \mbox{\hyperlink{alpide__hitmap_8cpp_a04b7c05c67bc55d083fa9a9f7d963efe}{open\_file}}(\mbox{\hyperlink{classArgumentParser}{ArgumentParser}}\ parser)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00029}00029\ \ \ \ \ std::filesystem::path\ outfilepath(parser.\mbox{\hyperlink{classArgumentParser_ad21c880d53afb04d0a2de0ed067ae75b}{get\_value}}<std::string>(\textcolor{stringliteral}{"{}rawdata"{}}));}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00030}00030\ \ \ \ \ std::string\ outfilename\ =\ outfilepath.stem();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::filesystem::exists(outfilepath))\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00033}00033\ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}File\ not\ found:\ "{}}\ <<\ outfilepath\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00034}00034\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00035}00035\ \ \ \ \ std::ifstream\ outfile(outfilepath,std::ios::binary);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{return}\ outfile;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00037}00037\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00039}\mbox{\hyperlink{alpide__hitmap_8cpp_a7c9fc00882c98f322e9092caf68265dc}{00039}}\ std::vector<uint8\_t>\ \mbox{\hyperlink{alpide__hitmap_8cpp_a7c9fc00882c98f322e9092caf68265dc}{read\_file}}(std::ifstream\&\ outfile,\ \textcolor{keywordtype}{int}\&\ nev)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00040}00040\ \ \ \ \ \textcolor{keywordtype}{char}\ buf[\textcolor{keyword}{sizeof}(uint8\_t)];}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00041}00041\ \ \ \ \ std::vector<uint8\_t>\ values;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00042}00042\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00043}00043\ \ \ \ \ \textcolor{keywordflow}{while}\ (outfile.read(buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ values.push\_back(0);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ \ memcpy(\&values[nev],\ buf,\ \textcolor{keyword}{sizeof}(values[nev]));}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ \ nev++;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00047}00047\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{return}\ values;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00049}00049\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00051}\mbox{\hyperlink{alpide__hitmap_8cpp_a01b1ff7ed3c45bf1852744940997075c}{00051}}\ std::vector<ALPIDE::TEvent>\ \mbox{\hyperlink{alpide__hitmap_8cpp_a01b1ff7ed3c45bf1852744940997075c}{decode\_event}}(std::vector<uint8\_t>\&\ values)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00052}00052\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00053}00053\ \ \ \ \ std::vector<ALPIDE::TEvent>\ events;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00054}00054\ \ \ \ \ ALPIDE::TDecoder*\ decoder\ =\ \textcolor{keyword}{new}\ ALPIDE::TDecoder();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00055}00055\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ values.size())\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ events.push\_back(decoder-\/>alpide\_decode\_event(values,i));}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00057}00057\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00058}00058\ \ \ \ \ \textcolor{keywordflow}{return}\ events;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00059}00059\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00061}\mbox{\hyperlink{alpide__hitmap_8cpp_a55ec32a595c43835729286bb2fa2ddcb}{00061}}\ TCanvas*\ \mbox{\hyperlink{alpide__hitmap_8cpp_a55ec32a595c43835729286bb2fa2ddcb}{draw\_hitmap}}(std::vector<ALPIDE::TEvent>\&\ events)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00062}00062\ \ \ \ \ TCanvas*\ c1\ =\ \textcolor{keyword}{new}\ TCanvas(\textcolor{stringliteral}{"{}c1"{}},\textcolor{stringliteral}{"{}c1"{}},2000,775);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00063}00063\ \ \ \ \ TH2I*\ hm\ =\ \textcolor{keyword}{new}\ TH2I(\textcolor{stringliteral}{"{}hm"{}},\textcolor{stringliteral}{"{}Hitmap;\ Column;\ Row"{}},1024,0,1024,512,0,512);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{for}(ALPIDE::TEvent\ event\ :\ events)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(std::array<int,2>\ coord\ :\ \textcolor{keyword}{event}.getCoords())\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ hm-\/>Fill(coord[0],coord[1]);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00068}00068\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00070}00070\ \ \ \ \ hm-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00071}00071\ \ \ \ \ hm-\/>GetXaxis()-\/>SetNdivisions(4,4,4,kFALSE);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00072}00072\ \ \ \ \ hm-\/>GetXaxis()-\/>SetTickLength(-\/0.035);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00073}00073\ \ \ \ \ hm-\/>GetXaxis()-\/>SetLabelOffset(0.03);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00074}00074\ \ \ \ \ hm-\/>GetXaxis()-\/>CenterTitle();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00075}00075\ \ \ \ \ hm-\/>GetXaxis()-\/>SetTitleOffset(1.4);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00077}00077\ \ \ \ \ hm-\/>GetYaxis()-\/>SetNdivisions(2,4,4,kFALSE);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00078}00078\ \ \ \ \ hm-\/>GetYaxis()-\/>SetTickLength(-\/0.018);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00079}00079\ \ \ \ \ hm-\/>GetYaxis()-\/>SetLabelOffset(0.017);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00080}00080\ \ \ \ \ hm-\/>GetYaxis()-\/>CenterTitle();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00081}00081\ \ \ \ \ hm-\/>GetYaxis()-\/>SetTitleOffset(0.9);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00083}00083\ \ \ \ \ hm-\/>GetZaxis()-\/>SetMaxDigits(2);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00084}00084\ \ \ \ \ hm-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}dE/d[Row]d[Column]"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00085}00085\ \ \ \ \ hm-\/>GetZaxis()-\/>SetTitleOffset(0.6);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00087}00087\ \ \ \ \ gStyle-\/>SetTitleX(0.38);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00088}00088\ \ \ \ \ gStyle-\/>SetTitleY(0.98);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00089}00089\ \ \ \ \ c1-\/>SetTopMargin(0.085);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00090}00090\ \ \ \ \ c1-\/>SetBottomMargin(0.115);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00091}00091\ \ \ \ \ c1-\/>SetLeftMargin(0.065);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00092}00092\ \ \ \ \ c1-\/>SetRightMargin(0.315);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00094}00094\ \ \ \ \ std::vector<int>\ hitrate=\{0\};}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00095}00095\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 1024;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ 1024;\ j++)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ hitrate.push\_back(hm-\/>GetBinContent(i,j));}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00099}00099\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00101}00101\ \ \ \ \ sort(hitrate.rbegin(),hitrate.rend());}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00102}00102\ \ \ \ \ TPaveText\ *pt\ =\ \textcolor{keyword}{new}\ TPaveText(1170,0,1515,256);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00103}00103\ \ \ \ \ \textcolor{keywordtype}{double}\ total\ =\ (events.size()*1024.*512.);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00104}00104\ \ \ \ \ pt-\/>AddText(\textcolor{stringliteral}{"{}Hit\ rate\ \ \ \ 0\ masked:"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00105}00105\ \ \ \ \ TString\ str\ =\ Form(\textcolor{stringliteral}{"{}\ \ \ \ \%.2e\ per\ pixel\ per\ event"{}},accumulate(hitrate.begin(),\ hitrate.end(),\ 0)/total);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00106}00106\ \ \ \ \ pt-\/>AddText(str);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00107}00107\ \ \ \ \ pt-\/>AddText(\textcolor{stringliteral}{"{}Hit\ rate\ \ \ 10\ masked:"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00108}00108\ \ \ \ \ str\ =\ Form(\textcolor{stringliteral}{"{}\ \ \ \ \%.2e\ per\ pixel\ per\ event"{}},accumulate(hitrate.begin()+10,\ hitrate.end(),\ 0)/total);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00109}00109\ \ \ \ \ pt-\/>AddText(str);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00110}00110\ \ \ \ \ pt-\/>AddText(\textcolor{stringliteral}{"{}Hit\ rate\ \ 100\ masked:"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00111}00111\ \ \ \ \ str\ =\ Form(\textcolor{stringliteral}{"{}\ \ \ \ \%.2e\ per\ pixel\ per\ event"{}},accumulate(hitrate.begin()+100,\ hitrate.end(),\ 0)/total);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00112}00112\ \ \ \ \ pt-\/>AddText(str);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00113}00113\ \ \ \ \ pt-\/>AddText(\textcolor{stringliteral}{"{}Hit\ rate\ 1000\ masked:"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00114}00114\ \ \ \ \ str\ =\ Form(\textcolor{stringliteral}{"{}\ \ \ \ \%.2e\ per\ pixel\ per\ event"{}},accumulate(hitrate.begin()+1000,\ hitrate.end(),\ 0)/total);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00115}00115\ \ \ \ \ pt-\/>AddText(str);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00116}00116\ \ \ \ \ c1-\/>Update();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00117}00117\ \ \ \ \ pt-\/>SetTextAlign(12);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00118}00118\ \ \ \ \ pt-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00120}00120\ \ \ \ \ \textcolor{keywordflow}{return}\ c1;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00121}00121\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00123}\mbox{\hyperlink{alpide__hitmap_8cpp_ac491fb9795132eeb049cd64db2ca8bc0}{00123}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{alpide__hitmap_8cpp_ac491fb9795132eeb049cd64db2ca8bc0}{save\_canvas}}(\mbox{\hyperlink{classArgumentParser}{ArgumentParser}}\&\ parser,\ TCanvas*\&\ c1)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00124}00124\ \ \ \ \ std::filesystem::path\ outfilepath(parser.\mbox{\hyperlink{classArgumentParser_ad21c880d53afb04d0a2de0ed067ae75b}{get\_value}}<std::string>(\textcolor{stringliteral}{"{}rawdata"{}}));}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00125}00125\ \ \ \ \ std::string\ outfilename\ =\ outfilepath.stem();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00126}00126\ \ \ \ \ std::filesystem::path\ outputfile\ =\ parser.\mbox{\hyperlink{classArgumentParser_ad21c880d53afb04d0a2de0ed067ae75b}{get\_value}}<std::string>(\textcolor{stringliteral}{"{}path"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00127}00127\ \ \ \ \ outputfile.append(outfilename+\textcolor{stringliteral}{"{}.pdf"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00128}00128\ \ \ \ \ std::cout\ <<\ outputfile\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00129}00129\ \ \ \ \ c1-\/>SaveAs((TString)\ outputfile);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00130}00130\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00132}\mbox{\hyperlink{alpide__hitmap_8cpp_a1fdac460e0f2fa59ddf3dd923355e985}{00132}}\ TCanvas*\ \mbox{\hyperlink{alpide__hitmap_8cpp_a1fdac460e0f2fa59ddf3dd923355e985}{draw\_histogram}}(std::vector<ALPIDE::TEvent>\&\ events)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00133}00133\ \ \ \ \ gStyle-\/>SetTitleX(0.5);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00134}00134\ \ \ \ \ gStyle-\/>SetTitleY(1);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00135}00135\ \ \ \ \ TCanvas*\ c2\ =\ \textcolor{keyword}{new}\ TCanvas(\textcolor{stringliteral}{"{}c2"{}},\textcolor{stringliteral}{"{}c2"{}},2000,1000);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00136}00136\ \ \ \ \ c2-\/>Divide(2,1);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00137}00137\ \ \ \ \ c2-\/>cd(1);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00138}00138\ \ \ \ \ TH1I*\ eventHist\ =\ \textcolor{keyword}{new}\ TH1I(\textcolor{stringliteral}{"{}h1"{}},\textcolor{stringliteral}{"{}eventHist"{}},150,0,events.back().getEventNum()+1);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00139}00139\ \ \ \ \ std::cout\ <<\ (\textcolor{keywordtype}{long}\ int)\ events[0].getTime()\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00140}00140\ \ \ \ \ TH1I*\ timeHist\ =\ \textcolor{keyword}{new}\ TH1I(\textcolor{stringliteral}{"{}h2"{}},\textcolor{stringliteral}{"{}timeHist"{}},150,events[0].getTime(),events.back().getTime());}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{for}\ (ALPIDE::TEvent\ event\ :\ events)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (std::array<int,2>\ coord\ :\ \textcolor{keyword}{event}.getCoords())\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ eventHist-\/>Fill(event.getEventNum());}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ timeHist-\/>Fill(event.getTime());}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00146}00146\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00147}00147\ \ \ \ \ eventHist-\/>Draw();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00148}00148\ \ \ \ \ c2-\/>cd(2);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00149}00149\ \ \ \ \ timeHist-\/>Draw();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00151}00151\ \ \ \ \ c2-\/>SaveAs(\textcolor{stringliteral}{"{}data/histogram.png"{}});}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00153}00153\ \ \ \ \ \textcolor{keywordflow}{return}\ c2;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00154}00154\ \}}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00155}\mbox{\hyperlink{alpide__hitmap_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{00155}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{alpide__hitmap_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}**\ argv)\ \{}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00156}00156\ \ \ \ \ TClock*\ clock\ =\ \textcolor{keyword}{new}\ TClock();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00157}00157\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}ALPIDE\ Decoding..."{}}\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00158}00158\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00159}00159\ \ \ \ \ \mbox{\hyperlink{classArgumentParser}{ArgumentParser}}\ parser\ =\ \mbox{\hyperlink{alpide__hitmap_8cpp_aab44b1dab240272ed0bee958aa729f94}{set\_parse}}(argc,argv);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00160}00160\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00161}00161\ \ \ \ \ std::ifstream\ outfile\ =\ \mbox{\hyperlink{alpide__hitmap_8cpp_a04b7c05c67bc55d083fa9a9f7d963efe}{open\_file}}(parser);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00163}00163\ \ \ \ \ \textcolor{keywordtype}{int}\ nev\ =\ 0;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00164}00164\ \ \ \ \ std::vector<uint8\_t>\ values\ =\ \mbox{\hyperlink{alpide__hitmap_8cpp_a7c9fc00882c98f322e9092caf68265dc}{read\_file}}(outfile,nev);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00166}00166\ \ \ \ \ std::vector<ALPIDE::TEvent>\ events\ =\ \mbox{\hyperlink{alpide__hitmap_8cpp_a01b1ff7ed3c45bf1852744940997075c}{decode\_event}}(values);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00168}00168\ \ \ \ \ TCanvas*\ c1\ =\ \mbox{\hyperlink{alpide__hitmap_8cpp_a55ec32a595c43835729286bb2fa2ddcb}{draw\_hitmap}}(events);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00169}00169\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00170}00170\ \ \ \ \ \mbox{\hyperlink{alpide__hitmap_8cpp_ac491fb9795132eeb049cd64db2ca8bc0}{save\_canvas}}(parser,\ c1);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00172}00172\ \ \ \ \ \mbox{\hyperlink{alpide__hitmap_8cpp_a1fdac460e0f2fa59ddf3dd923355e985}{draw\_histogram}}(events);}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00174}00174\ \ \ \ \ clock-\/>EndProgram();}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00175}00175\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{alpide__hitmap_8cpp_source_l00176}00176\ \}}

\end{DoxyCode}
